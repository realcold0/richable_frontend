import{_ as K,r as l,m as q,B as z,b as G,c as m,a as t,z as u,i as d,w as H,N as J,F as O,A as Q,x as E,E as X,C as tt,o as h,p as et,j as ot}from"./index-E7HFo_Uv.js";import{C as L,r as at}from"./chart-BZRWlfz0.js";import{a as D}from"./AxiosInstance--4YUcpg_.js";import{u as st}from"./curMonth-BeaD9XSL.js";import"./axios-CCb-kr4I.js";const M=_=>(et("data-v-73309fbf"),_=_(),ot(),_),nt={class:"container"},ct={class:"month-navigation text-center"},lt={class:"text-center total-asset"},rt={class:"asset-title"},it={class:"asset-amount"},dt={class:"avg-content"},ut=M(()=>t("div",{class:"text-left category-comparison"},[t("div",{class:"sub-title"},"대한민국 평균 소비금액을 기준으로 비교해요"),t("div",{class:"main-title"},"나는 평균 대비 얼마나 지출할까요?")],-1)),vt={class:"text-center"},pt={class:"total-consume"},mt={class:"consume-title"},ht=["value"],gt={class:"consume-title"},ft=M(()=>t("div",{class:"chart-container"},[t("canvas",{style:{"margin-top":"20px"},id:"myChart"})],-1)),_t={class:"saving-content"},yt=M(()=>t("div",{class:"summary-header"},[t("div",{class:"main-title"},"6개월 간 소비를 절약했을 때")],-1)),bt={key:0},xt={class:"total-consume"},Ct={class:"consume-title"},St={style:{"font-size":"18px","font-weight":"500",color:"#FF0062"}},Mt={class:"consume-title"},kt={style:{"font-size":"18px","font-weight":"500",color:"#FF0062"}},wt=M(()=>t("canvas",{style:{"margin-top":"20px"},id:"savingChart"},null,-1)),Bt={__name:"CompareConsumePage",setup(_){L.register(...at);const v=st(),c=l(v.month),r=l(v.year);console.log(c,r);const y=l("식료품"),A=l(["식료품","유흥","쇼핑","공과금","생활용품","의료비","교통비","통신비","문화","교육비","외식 · 숙박","기타"]),b=l(0),g=l(0),x=l(0),p=q(()=>b.value-x.value),k=l([]),I=l([]),W={식료품:"식료품 · 비주류음료",유흥:"주류 · 담배",쇼핑:"의류 · 신발",공과금:"주거 · 수도 · 광열",생활용품:"가정용품 · 가사서비스",의료비:"보건",교통비:"교통",통신비:"통신",문화:"오락 · 문화",교육비:"교육","외식 · 숙박":"음식 · 숙박",기타:"기타상품 · 서비스"};function Y(a){return W[a]||"매핑되지 않은 컬럼"}let w=null,B=null;const T=()=>{const{year:a,month:e}=v.decreaseMonth();c.value=e,r.value=a,f(),C(),S()},V=()=>{const{year:a,month:e}=v.increaseMonth();c.value=e,r.value=a,f(),C(),S()};z(y,()=>{f()}),z([c,r],()=>{C(),S(),f()});const f=async()=>{const a=r.value,e=c.value,o=Y(y.value),s=encodeURIComponent(o),i=(await D.get(`/outcome/compare/${a}/${e}/${s}`)).data.response.data;b.value=i.mySum,x.value=i.averageSum,console.log(b.value,x.value),N()},C=async()=>{const a=r.value,e=c.value,s=(await D.get(`/outcome/review/sum/${a}/${e}`)).data.response.data;g.value=Math.abs(s.possibleSaveAmount),console.log(g.value)},S=async()=>{const a=r.value,e=c.value,s=(await D.get(`/outcome/simulation/${a}/${e}`)).data.response.data;console.log(s),k.value=s.possibleSaveAmount.map(n=>Math.abs(n)),I.value=s.saveAmount.map(n=>Math.abs(n)),tt(()=>{const n=document.getElementById("savingChart");n&&(n.getContext("2d")?P(s.months,I.value,k.value):console.error("Cannot find canvas element for savingChart"))})},N=()=>{const a=document.getElementById("myChart").getContext("2d");w&&w.destroy(),w=new L(a,{type:"bar",data:{labels:["평균 소비","나의 소비"],datasets:[{label:"소비 비교",data:[x.value,b.value],backgroundColor:["#d3d3d3","#ff6384"],borderWidth:1,borderRadius:10,barThickness:50}]},options:{responsive:!0,layout:{padding:{top:20}},scales:{y:{grid:{display:!1},beginAtZero:!0,ticks:{callback:function(e){return e.toLocaleString()+"원"}}},x:{grid:{display:!1},ticks:{color:"#767676"}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){return e.raw.toLocaleString()+"원"}}}}},plugins:[{id:"barLabels",afterDatasetsDraw(e){const{ctx:o,data:s,scales:{x:n,y:i}}=e;o.save(),o.font="12px Pretendard",o.fillStyle="#767676",o.textAlign="center",o.textBaseline="bottom",s.datasets.forEach((R,U)=>{e.getDatasetMeta(U).data.forEach(($,Z)=>{const F=R.data[Z],j=F>=1e5?`${Math.floor(F/1e4)}만원`:`${F.toLocaleString()}원`;o.fillText(j,$.x,$.y-5)})}),o.restore()}}]})},P=(a,e,o)=>{var n;const s=(n=document.getElementById("savingChart"))==null?void 0:n.getContext("2d");if(!s){console.error("Cannot get context for savingChart");return}B&&B.destroy(),console.log(e,o),B=new L(s,{type:"line",data:{labels:a,datasets:[{label:"절약했을 때 저축",data:e,borderColor:"#FF6384",fill:!1,borderWidth:2},{label:"평소 저축",data:o,borderColor:"#D3D3D3",fill:!1,borderWidth:2}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,ticks:{callback:function(i){return i.toLocaleString()+"원"}}}},plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:function(i){return i.raw.toLocaleString()+"원"}}}}}})};return G(()=>{f(),C(),S(),c.value=v.month,r.value=v.year}),(a,e)=>(h(),m("div",nt,[t("div",ct,[t("button",{onClick:T,class:"btn custom-btn-left"}),t("div",null,u(c.value)+"월",1),t("button",{onClick:V,class:"btn custom-btn-right"})]),t("div",lt,[t("div",rt,u(p.value>0?"이번 달에 아낄 수 있었던 비용이에요 😢":"이번달에 아낀 비용이에요"),1),t("div",it,u(Math.abs(g.value).toLocaleString())+"원",1)]),t("div",dt,[ut,t("div",vt,[t("div",pt,[t("div",mt,[d(" 나의 이번 달 "),H(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>y.value=o),class:"form-select custom-inline-select",style:{"font-size":"18px","font-weight":"700","background-color":"none"}},[(h(!0),m(O,null,Q(A.value,o=>(h(),m("option",{key:o,value:o},u(o),9,ht))),128))],512),[[J,y.value]]),d(" 소비는 ")]),t("div",gt,[d(" 평균보다 "),t("span",{style:E({color:p.value>0?"#EB003B":"#2768FF",fontSize:"18px",fontWeight:"700"})},u(Math.abs(p.value).toLocaleString())+"원 ",5),p.value>0?(h(),m("span",{key:0,style:E({color:p.value>0?"#EB003B":"#2768FF",fontSize:"18px",fontWeight:"700"})}," 많습니다",4)):(h(),m("span",{key:1,style:E({color:p.value>0?"#EB003B":"#2768FF",fontSize:"18px",fontWeight:"700"})},"적습니다",4)),d(". ")])]),ft])]),t("div",_t,[yt,k.value.length>0?(h(),m("div",bt,[t("div",xt,[t("div",Ct,[d(" 이번 달 소비 중 줄일 수 있는 소비는 "),t("span",St,u(Math.abs(g.value).toLocaleString()),1),d(" 원 이에요. ")]),t("div",Mt,[d(" 6개월 동안 "),t("span",kt,u(Math.abs(g.value*6).toLocaleString()),1),d(" 원 절약이 가능해요! ")])]),wt])):X("",!0)])]))}},$t=K(Bt,[["__scopeId","data-v-73309fbf"]]);export{$t as default};
