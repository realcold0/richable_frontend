import{u as B}from"./curMonth-BeaD9XSL.js";import{_ as E,h as P,o as g,c as y,a as e,f as w,z as c,I as x,r,b as Y,B as j,i as F,F as N,A as T,x as H,g as K,E as Q,C as J,p as O,j as R,n as U}from"./index-E7HFo_Uv.js";import{C as z,g as X,p as Z,a as ee,A as te,c as q,L as G,D as oe,f as se,e as ae,d as ne}from"./chart-BZRWlfz0.js";import{a as V}from"./AxiosInstance--4YUcpg_.js";import"./axios-CCb-kr4I.js";const le={class:"wrapper"},ce={class:"monthWrapper"},re={class:"date"},ie={id:"year"},de={id:"month"},ue={__name:"SelectMonth",setup(d){const t=B(),h=new Date().getFullYear(),m=new Date().getMonth()+1,s=()=>{t.decreaseMonth()},u=()=>{(t.year<h||t.year===h&&t.month<m)&&t.increaseMonth()};return(i,b)=>{const v=P("font-awesome-icon");return g(),y("div",le,[e("div",ce,[e("div",{id:"left",onClick:s},[w(v,{icon:["fas","caret-left"],class:"icon"})]),e("div",re,[e("div",ie,c(x(t).year),1),e("div",de,c(x(t).month)+"월",1)]),e("div",{id:"right",onClick:u},[w(v,{icon:["fas","caret-right"],class:"icon"})])])])}}},he=E(ue,[["__scopeId","data-v-3e9bc8ba"]]),I=d=>(O("data-v-2c2dc3d0"),d=d(),R(),d),_e={class:"wrapper"},pe={class:"text-center total-asset"},me=I(()=>e("div",{class:"asset-title"},"김리치님의 이번 달 총 소비💸",-1)),ve={class:"asset-amount"},ge={style:{"margin-top":"100px"}},ye=I(()=>e("div",{class:"text-left category-comparison"},[e("div",{class:"main-title"},"나의 소비")],-1)),fe={class:"analyzeText"},Ce={id:"month"},be={id:"mostCategory"},we={style:{"margin-top":"8px"},class:"analyzeWrapper"},Se={class:"analyze"},Me={class:"chart"},$e={class:"consumeSummary"},xe={class:"consumeList"},De={class:"total-row"},ke=I(()=>e("th",{style:{width:"30%"}},"총 소비",-1)),Fe=I(()=>e("th",{style:{width:"30%"}},null,-1)),Ie={style:{width:"40%"}},Le=["onClick"],Ae={key:0,class:"modal"},We={class:"modal-content"},ze=I(()=>e("button",{class:"btn btn-pink"},"세부항목 보러가기",-1)),Ee={__name:"ConsumeCategorySum",setup(d){z.register(X,Z,ee,te,q,G,oe);const t=B(),h=r(null);let m=null;const s=r(0),u=r([]),i=r([]),b=r([]);let v=r([]),f=r([]);const D=["#FF0062","#C30044","#DA0052","#FFF2F6","#DCD4D4"],S=r(!1),_=r({}),L={식료품:"식료품","식료품 · 비주류음료":"식료품","주류 · 담배":"유흥","의류 · 신발":"쇼핑","주거 · 수도 · 광열":"공과금","가정용품 · 가사서비스":"생활용품",보건:"의료비",교통:"교통비",통신:"통신비","오락 · 문화":"문화",교육:"교육비","음식 · 숙박":"외식·숙박","기타상품 · 서비스":"기타"},k=a=>{a.category==="그 외"?(_.value=a,b.value=u.value.slice(4)):(_.value=a,b.value=u.value.filter(l=>l.category===a.category)),S.value=!0},M=()=>{S.value=!1},n=()=>{const a={};u.value.forEach(o=>{const C=L[o.category]||"기타";a[C]||(a[C]=0),a[C]+=o.sum});const l=Object.entries(a).map(([o,C])=>({category:o,sum:C}));if(l.length>5){const o=l.slice(0,4),W=l.slice(4).reduce((p,$)=>p+$.sum,0);i.value=[...o,{category:"그 외",sum:W}]}else i.value=l;v.value=i.value.map(o=>o.category||"없음"),f.value=i.value.map(o=>o.sum||0)},A=async()=>{await J(),m&&m.destroy();try{const l=(await V.get(`/outcome/category/sum/${t.year}/${t.month}`)).data.response.data;u.value=l.categorys||[],s.value=l.sum||0,n()}catch(a){console.error("Axios 요청 실패:",a),v.value=[],f.value=[],s.value=0,u.value=[],i.value=[]}m=new z(h.value,{type:"doughnut",data:{labels:v.value,datasets:[{data:f.value,backgroundColor:D,hoverOffset:4}]},options:{responsive:!0,plugins:{legend:{position:"bottom",labels:{boxWidth:20,padding:20}}}}})};return Y(()=>{A()}),j(()=>t.month,()=>{A()}),(a,l)=>{var W;const o=P("font-awesome-icon"),C=P("router-link");return g(),y("div",_e,[e("div",pe,[me,e("div",ve,c(s.value!==null?s.value.toLocaleString():"0")+" 원",1)]),e("div",ge,[ye,e("div",fe,[e("div",null,[e("span",Ce,c(x(t).month)+"월",1),F("에는 "),e("span",be,c(((W=i.value[0])==null?void 0:W.category)||"데이터 없음"),1),F("에 가장 많은 소비를 하였습니다. ")])]),e("div",we,[e("div",Se,[e("div",Me,[e("canvas",{ref_key:"doughnutChart",ref:h},null,512)]),e("div",$e,[e("table",xe,[e("thead",null,[e("tr",De,[ke,Fe,e("th",Ie,c(s.value!==null?s.value.toLocaleString():"0")+" 원",1)])]),e("tbody",null,[(g(!0),y(N,null,T(i.value,(p,$)=>(g(),y("tr",{key:$,onClick:He=>k(p)},[e("td",null,[w(o,{icon:["fas","circle"],class:"icon",style:H({color:D[$]||"#000"})},null,8,["style"]),F(" "+c(p.category||"없음"),1)]),e("td",null,c(s.value>0?Math.round(p.sum/s.value*100):0)+"%",1),e("td",null,c(p.sum!==null?p.sum.toLocaleString():"0")+" 원",1)],8,Le))),128))])])])])])]),S.value?(g(),y("div",Ae,[e("div",We,[e("span",{class:"close",onClick:M},"×"),e("h3",null,c(_.value.category)+"의 세부 항목",1),e("ul",null,[(g(!0),y(N,null,T(b.value,(p,$)=>(g(),y("li",{key:$},c(p.category)+": "+c(p.sum.toLocaleString())+" 원 ",1))),128))]),w(C,{to:{path:"/budget/list",query:{category:_.value.category}}},{default:K(()=>[ze]),_:1},8,["to"])])])):Q("",!0)])}}},Pe=E(Ee,[["__scopeId","data-v-2c2dc3d0"]]),Ve=d=>(O("data-v-9bbef713"),d=d(),R(),d),Be={class:"wrapper"},Ne={style:{width:"1000px"}},Te=Ve(()=>e("div",{class:"text-left category-comparison"},[e("div",{class:"main-title"},"전달 소비 누계 비교")],-1)),Ye={class:"consumeCompareTitle"},je={class:"graphWrapper"},Je={class:"graph"},Oe={__name:"ConsumeCompareMonth",setup(d){z.register(se,ae,ne,q,G);const t=B(),h=r(null);let m=null;const s=r([]),u=r([]),i=new Date,b=i.getFullYear(),v=i.getMonth()+1,f=i.getDate(),D=Array.from({length:31},(k,M)=>M+1),S=r("");let _=0;const L=async()=>{await J(),m&&m.destroy(),h.value.getContext("2d"),await V.get(`/outcome/category/dailysum/${t.year}/${t.month}`).then(n=>{t.year===b&&t.month===v?s.value=n.data.response.data.prices.slice(0,f):s.value=n.data.response.data.prices}).catch(n=>{console.log(n)}),await V.get(`/outcome/category/dailysum/${t.getPrevMonth.year}/${t.getPrevMonth.month}`).then(n=>{u.value=n.data.response.data.prices}).catch(n=>{console.log(n)});const k=s.value[f-1]||0,M=u.value[f-1]||0;_=k-M,S.value=`${Math.abs(_).toLocaleString()}`,m=new z(h.value,{type:"line",data:{labels:D,datasets:[{label:t.month+"월",data:s.value,fill:!1,borderColor:"#FF0062",borderWidth:2,borderCapStyle:"round",borderJoinStyle:"round",tension:.4,pointRadius:D.map(n=>t.year===b&&t.month===v&&n===f?6:0),pointBackgroundColor:"#FF0062"},{label:t.getPrevMonth.month+"월",data:u.value,fill:!0,borderColor:"#D1D6D9",borderWidth:2,borderCapStyle:"round",borderJoinStyle:"round",tension:.4,pointRadius:0,backgroundColor:function(n){const A=n.chart,{ctx:a,chartArea:l}=A;if(!l)return null;const o=a.createLinearGradient(0,l.bottom,0,l.top);return o.addColorStop(0,"rgba(209, 214, 217, 0)"),o.addColorStop(1,"rgba(209, 214, 217, 0.5)"),o}}]},options:{responsive:!0,plugins:{legend:{position:"bottom",labels:{boxWidth:20,padding:20}}},elements:{line:{tension:.4},point:{radius:0}},scales:{x:{grid:{display:!1}},y:{display:!1,grid:{display:!1}}}}})};return Y(()=>{L()}),j(()=>t.month,()=>{L()}),(k,M)=>(g(),y("div",Be,[e("div",Ne,[Te,e("div",Ye,[F(" 저번 달보다 "),e("span",{class:U({"highlight-more":x(_)>0,"highlight-less":x(_)<=0})},c(S.value)+"원 "+c(x(_)>0?"더 ":"덜 "),3),F(" 썼어요! ")]),e("div",je,[e("div",Je,[e("canvas",{ref_key:"lineChart",ref:h},null,512)])])])]))}},Re=E(Oe,[["__scopeId","data-v-9bbef713"]]),qe={class:"pageWrapper"},Ge={__name:"ConsumeAnalysisPage",setup(d){return(t,h)=>(g(),y("div",qe,[w(he),w(Pe),w(Re)]))}},et=E(Ge,[["__scopeId","data-v-d35c83d8"]]);export{et as default};
