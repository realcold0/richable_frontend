import{_ as L,r as _,o as f,c as x,a as e,w as G,N as R,v as I,p as S,j as F,m as Z,h as z,z as h,f as A,b as ee,i as D,x as T,F as B,A as te,E as P,e as oe}from"./index-E7HFo_Uv.js";import{M as N}from"./bootstrap.esm-DOzSzUNx.js";import{a as w}from"./AxiosInstance--4YUcpg_.js";import"./axios-CCb-kr4I.js";const k=i=>(S("data-v-2b136610"),i=i(),F(),i),ae={class:"modal-dialog"},le={class:"modal-content"},se=k(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"consumeGoalCreateLabel",style:{"font-weight":"bold"}}," 소비 목표 등록 "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),ne={class:"modal-body",style:{padding:"32px","padding-bottom":"12px"}},de={class:"mb-3"},ie=k(()=>e("label",{class:"form-label",style:{"font-weight":"bold"}},"분류",-1)),ce=k(()=>e("option",{value:"소비"},"소비",-1)),re=k(()=>e("option",{value:"저축"},"저축",-1)),ue=[ce,re],me={class:"mb-3"},pe=k(()=>e("label",{class:"form-label",style:{"font-weight":"bold"}},"목표명",-1)),_e={class:"mb-3"},ve=k(()=>e("label",{class:"form-label",style:{"font-weight":"bold"}},"목표량",-1)),he=k(()=>e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"취소",-1)),be={__name:"ConsumeGoalCreateModal",emits:["registerGoal"],setup(i,{expose:b,emit:c}){const t=_({type:"소비",title:"",totalAmount:0}),s=_(null);let u=null;const n=c,m=async()=>{if(t.value.title&&t.value.totalAmount>0)try{const o=await w.post("/goal/set",{category:t.value.type,title:t.value.title,amount:t.value.totalAmount});o.data.success?(n("registerGoal",t.value),u&&u.hide(),y()):console.error("Failed to submit goal:",o.data)}catch(o){console.error("Error submitting goal:",o)}else alert("모든 필드를 올바르게 입력해주세요.")},g=()=>{!u&&s.value?(u=new N(s.value,{backdrop:"static",keyboard:!0}),u.show()):u&&u.show()},y=()=>{t.value={type:"소비",title:"",totalAmount:0}};return b({show:g}),(o,a)=>(f(),x("div",{class:"modal fade",id:"consumeGoalCreateModal",tabindex:"-1","aria-labelledby":"consumeGoalCreateLabel","aria-hidden":"true",ref_key:"modal",ref:s},[e("div",ae,[e("div",le,[se,e("div",ne,[e("div",de,[ie,G(e("select",{"onUpdate:modelValue":a[0]||(a[0]=r=>t.value.type=r),class:"form-control"},ue,512),[[R,t.value.type]])]),e("div",me,[pe,G(e("input",{"onUpdate:modelValue":a[1]||(a[1]=r=>t.value.title=r),type:"text",class:"form-control",placeholder:"목표명을 입력해주세요"},null,512),[[I,t.value.title]])]),e("div",_e,[ve,G(e("input",{"onUpdate:modelValue":a[2]||(a[2]=r=>t.value.totalAmount=r),type:"number",class:"form-control",placeholder:"목표량을 입력해주세요"},null,512),[[I,t.value.totalAmount]])])]),e("div",{class:"modal-footer d-flex"},[he,e("button",{type:"button",class:"btn custom-register-btn",onClick:m},"등록")])])])],512))}},ge=L(be,[["__scopeId","data-v-2b136610"]]),C=i=>(S("data-v-0f6e6c40"),i=i(),F(),i),ye={class:"modal-dialog"},fe={class:"modal-content"},xe=C(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"consumeGoalDetailLabel",style:{"font-weight":"bold"}}," 목표 자산 항목 조회 "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),we={class:"modal-body",style:{padding:"32px","padding-bottom":"12px"}},$e={class:"mb-3",style:{display:"flex"}},Ge=C(()=>e("label",{class:"form-label",style:{"font-weight":"bold",width:"70px","padding-top":"8px"}},"분류",-1)),ke={class:"mb-3",style:{display:"flex"}},Ae=C(()=>e("label",{class:"form-label",style:{"font-weight":"bold",width:"70px","padding-top":"8px"}},"목표명",-1)),Ce={class:"mb-3",style:{display:"flex"}},Me=C(()=>e("label",{class:"form-label",style:{"font-weight":"bold",width:"70px","padding-top":"8px"}},"목표량",-1)),De={class:"input-group"},Ie=C(()=>e("span",{class:"input-group-text"},"원",-1)),Le={class:"modal-footer d-flex"},Se=C(()=>e("button",{type:"button",class:"btn","data-bs-dismiss":"modal",style:{"background-color":"white",border:"1px solid #020202",color:"#020202","font-weight":"bold","margin-right":"12px"}}," 취소 ",-1)),Fe={__name:"ConsumeGoalDetailModal",emits:["deleteGoal","achieveGoal"],setup(i,{expose:b,emit:c}){const t=_({id:null,type:"",name:"",amount:0}),s=Z(()=>t.value.amount.toLocaleString()),u=_(null);let n=null;const m=a=>{console.log("Received goalData:",a),t.value={id:a.id,index:a.index||a.id,type:a.type,name:a.name,amount:a.amount,progress:a.progress},!n&&u.value?(n=new N(u.value,{backdrop:"static",keyboard:!0}),n.show()):n&&n.show(),console.log("Goal detail set to:",t.value)},g=async()=>{try{console.log("Attempting to delete goal with index:",t.value.index);const a=await w({method:"delete",url:"/goal/delete",data:{index:t.value.index,category:t.value.type}});a.data&&a.data.success?(o("deleteGoal",t.value.id),n.hide()):(console.error("Failed to delete goal:",a.data),alert("새로고침 후 다시 시도해주세요."))}catch(a){console.error("Error deleting goal:",a)}},y=async()=>{if(Number(t.value.progress)===100)try{const r=await w({method:"put",url:"/goal/set",data:{index:t.value.index,isAchive:!0}});r.data.success?(alert("목표가 달성되었습니다."),o("achieveGoal",t.value.index),n.hide()):(console.error("Goal achievement failed:",r.data),alert("목표 달성에 실패했습니다."))}catch(r){console.error("Error achieving goal:",r)}else alert("목표가 아직 달성되지 않았습니다.")},o=c;return b({show:m}),(a,r)=>{const M=z("font-awesome-icon");return f(),x("div",{class:"modal fade",id:"consumeGoalDetailModal",tabindex:"-1","aria-labelledby":"consumeGoalDetailLabel","aria-hidden":"true",ref_key:"modal",ref:u},[e("div",ye,[e("div",fe,[xe,e("div",we,[e("div",$e,[Ge,e("div",null,h(t.value.type),1)]),e("div",ke,[Ae,e("div",null,h(t.value.name),1)]),e("div",Ce,[Me,e("div",De,[e("div",null,h(s.value),1),Ie])])]),e("div",Le,[e("button",{type:"button",class:"btn",onClick:g,style:{"background-color":"white",border:"1px solid #020202",color:"#020202","font-weight":"bold","margin-right":"12px"}},[A(M,{icon:"trash"})]),Se,e("button",{type:"button",class:"btn text-white",onClick:y,style:{"background-color":"#ff0062"}}," 달성 ")])])])],512)}}},Ve=L(Fe,[["__scopeId","data-v-0f6e6c40"]]),V=i=>(S("data-v-cfcaf92b"),i=i(),F(),i),Ue={class:"modal-dialog"},Ee={class:"modal-content"},Ne=V(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"assetGoalDetailLabel",style:{"font-weight":"bold"}}," 목표 자산 항목 조회 "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),je={class:"modal-body",style:{padding:"32px","padding-bottom":"12px"}},Te={class:"mb-3",style:{display:"flex","justify-content":"space-between"}},Be=V(()=>e("label",{class:"form-label",style:{"font-weight":"bold"}},"분 류",-1)),Pe={class:"mb-3",style:{display:"flex","justify-content":"space-between"}},Re=V(()=>e("label",{class:"form-label",style:{"font-weight":"bold"}},"목표량",-1)),ze={class:"input-group",style:{"text-align":"right"}},He=V(()=>e("span",{class:"input-group-text"},"원",-1)),Oe={class:"modal-footer d-flex justify-content-between"},qe=V(()=>e("button",{type:"button",class:"btn","data-bs-dismiss":"modal",style:{"background-color":"white",border:"1px solid #020202",color:"#020202","font-weight":"bold","margin-right":"12px"}}," 취소 ",-1)),Je={__name:"AssetGoalDetailModal",emits:["goalDeleted","goalUpdated"],setup(i,{expose:b,emit:c}){const t=c,s=_({index:null,title:"자산 형성",amount:1e8}),u=_(null);let n=null;const m=o=>{s.value={index:o.index||null,title:o.title||"자산 형성",amount:o.amount||0,category:o.category||"자산"},console.log("Goal Detail Set:",s.value),!n&&u.value?(n=new N(u.value,{backdrop:"static",keyboard:!0}),n.show()):n&&n.show()},g=async()=>{try{const o=await w.put(`/goal/${s.value.index}`,{amount:s.value.amount});o.data.success?(console.log("Goal successfully updated:",o.data.response.data),t("goalUpdated",s.value),n.hide()):console.error("Failed to update goal:",o.data)}catch(o){console.error("Error updating goal:",o)}},y=async()=>{if(s.value.index===null||!s.value.category){console.error("Invalid index or category, cannot delete goal."),alert("새로고침 후 다시 시도해주세요.");return}try{console.log("Attempting to delete goal with index:",s.value.index);const o=await w({method:"delete",url:"/goal/delete",data:{index:s.value.index,category:s.value.category}});o.data&&o.data.success?(t("goalDeleted"),n.hide()):(console.error("Failed to delete goal:",o.data),alert("새로고침 후 다시 시도해주세요."))}catch(o){console.error("Error deleting goal:",o)}};return b({show:m}),(o,a)=>{const r=z("font-awesome-icon");return f(),x("div",{class:"modal fade",id:"assetGoalDetailModal",tabindex:"-1","aria-labelledby":"assetGoalDetailLabel","aria-hidden":"true",ref_key:"modal",ref:u},[e("div",Ue,[e("div",Ee,[Ne,e("div",je,[e("div",Te,[Be,e("div",null,h(s.value.title),1)]),e("div",Pe,[Re,e("div",ze,[G(e("input",{"onUpdate:modelValue":a[0]||(a[0]=M=>s.value.amount=M),type:"number",class:"form-control"},null,512),[[I,s.value.amount]]),He])])]),e("div",Oe,[e("button",{type:"button",class:"btn",onClick:y,style:{"background-color":"white",border:"1px solid #020202",color:"#020202","font-weight":"bold"}},[A(r,{icon:"trash"})]),e("div",null,[qe,e("button",{type:"button",class:"btn text-white",style:{"background-color":"#ff0062"},onClick:g}," 수정 ")])])])])],512)}}},Ke=L(Je,[["__scopeId","data-v-cfcaf92b"]]),$=i=>(S("data-v-bb388411"),i=i(),F(),i),Qe={class:"modal-dialog"},We={class:"modal-content"},Xe=$(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"assetGoalCreateLabel",style:{"font-weight":"bold"}},"목표 자산 항목 등록"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),Ye={class:"modal-body"},Ze={class:"mb-3"},et=$(()=>e("label",{class:"form-label",style:{"font-weight":"bold"}},"목표명",-1)),tt={class:"mb-3"},ot=$(()=>e("label",{class:"form-label",style:{"font-weight":"bold"}},"분 류",-1)),at=$(()=>e("option",{value:"자산"},"자산",-1)),lt=$(()=>e("option",{value:"소비"},"소비",-1)),st=[at,lt],nt={class:"mb-3"},dt=$(()=>e("label",{class:"form-label",style:{"font-weight":"bold"}},"목표량",-1)),it={class:"input-group"},ct=$(()=>e("span",{class:"input-group-text"},"원",-1)),rt=$(()=>e("button",{type:"button",class:"btn","data-bs-dismiss":"modal",style:{"background-color":"white",border:"1px solid #020202",color:"#020202","font-weight":"bold"}},"취소",-1)),ut={__name:"AssetGoalCreateModal",emits:["registerGoal"],setup(i,{expose:b,emit:c}){const t=_({title:"",type:"자산",amount:null}),s=c,u=_(null);let n=null;const m=()=>{!n&&u.value?(n=new N(u.value,{backdrop:"static",keyboard:!0}),n.show()):n&&n.show()},g=async()=>{if(t.value.amount&&t.value.amount>0&&t.value.title)try{const o=await w.post("/goal/set",{category:t.value.type,amount:t.value.amount,title:t.value.title,date:new Date().getTime()});o.data.success?(console.log("Goal successfully created:",o.data.response.data),s("registerGoal",{...t.value}),n.hide(),y()):(console.error("Failed to create goal:",o.data),alert("목표 자산 등록에 실패했습니다."))}catch(o){console.error("Error creating goal:",o),alert("목표 자산 등록 중 오류가 발생했습니다.")}else alert("모든 필드를 입력해 주세요.")},y=()=>{t.value={title:"",type:"자산 형성",amount:null}};return b({show:m}),(o,a)=>(f(),x("div",{class:"modal fade",id:"assetGoalCreateModal",tabindex:"-1","aria-labelledby":"assetGoalCreateLabel","aria-hidden":"true",ref_key:"modal",ref:u},[e("div",Qe,[e("div",We,[Xe,e("div",Ye,[e("div",Ze,[et,G(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=r=>t.value.title=r),class:"form-control",placeholder:"목표명을 입력해 주세요"},null,512),[[I,t.value.title]])]),e("div",tt,[ot,G(e("select",{"onUpdate:modelValue":a[1]||(a[1]=r=>t.value.type=r),class:"form-select"},st,512),[[R,t.value.type]])]),e("div",nt,[dt,e("div",it,[G(e("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=r=>t.value.amount=r),class:"form-control",placeholder:"목표 금액을 입력해 주세요"},null,512),[[I,t.value.amount]]),ct])])]),e("div",{class:"modal-footer d-flex justify-content-between"},[rt,e("button",{type:"button",class:"btn text-white",style:{"background-color":"#FF0062"},onClick:g},"등록")])])])],512))}},mt=L(ut,[["__scopeId","data-v-bb388411"]]),U=i=>(S("data-v-dde43887"),i=i(),F(),i),pt={class:"goal-asset-list-page"},_t={class:"goal-progress-section goal-card"},vt=U(()=>e("div",null,"목표 자산을 추가하세요",-1)),ht=U(()=>e("div",null,"+",-1)),bt=[vt,ht],gt={class:"goal-description"},yt=U(()=>e("br",null,null,-1)),ft={class:"current-amount"},xt={class:"progress-bar"},wt={style:{"margin-top":"100px"}},$t=U(()=>e("section",{class:"text-left"},[e("div",{class:"main-title"},"소비 목표를 세워 목표 자금을 형성할 수 있어요"),e("div",{class:"sub_title"},"우선순위별로 소비 목표가 달성돼요 😁")],-1)),Gt={class:"goal-cards"},kt=["onDragstart","onDrop","onClick"],At={class:"goal-index"},Ct={class:"goal-amount"},Mt={class:"progress-bar"},Dt={class:"goal-progress"},It=U(()=>e("p",null,"+",-1)),Lt=[It],St={key:0,class:"goal-achieved-message"},Ft={key:0,class:"loading-spinner"},Vt={__name:"GoalAssetListPage",setup(i){const b=_(!1),c=_([]),t=_(!1);let s=null;const u=(l,p)=>{s=l},n=async l=>{const p=c.value.indexOf(s),d=c.value.indexOf(l);c.value.splice(p,1),c.value.splice(d,0,s);for(let v=0;v<c.value.length;v++)c.value[v].priority=v+1;try{await Promise.all(c.value.map(v=>{const E={index:v.id,priority:v.priority};return w.put("/goal/priority",E,{headers:{"Content-Type":"application/json"}})})),console.log("우선순위가 성공적으로 업데이트되었습니다.")}catch(v){console.error("우선순위 업데이트에 실패했습니다.",v)}s=null,await j()},m=_(null),g=_(!1),y=_(null),o=_(null),a=_(null),r=_(null),M=l=>{const p=c.value.length+1;c.value.push({id:p,title:l.title,totalAmount:l.totalAmount,gather:0}),console.log("새로운 목표가 추가되었습니다!")},H=l=>{m.value={totalAmount:l.amount,currentAmount:l.gather||0,remaindate:l.remaindate||0},g.value=!1,console.log("자산 목표가 추가되었습니다!")},O=()=>{y.value&&y.value.show()},q=l=>{o.value&&o.value.show({id:l.id,type:"소비",name:l.title,amount:l.totalAmount,progress:l.progress})},J=()=>{const l={type:"자산",amount:m.value.totalAmount,index:m.value.index,category:m.value.category};a.value.show(l)},K=()=>{r.value&&r.value.show()},Q=()=>{g.value=!0,console.log("자산 목표가 삭제되었습니다.")},W=l=>{const p=c.value.findIndex(d=>d.id===l);p!==-1&&(c.value.splice(p,1),console.log("목표를 달성했습니다!"),t.value=!0,setTimeout(()=>{t.value=!1},3e3))},X=l=>{confirm("정말로 이 목표를 삭제하시겠습니까?")&&(c.value=c.value.filter(p=>p.id!==l),console.log("목표가 삭제되었습니다."))},Y=async()=>{try{const l=await w.get("/goal/");if(l.data&&l.data.response&&l.data.response.data){const p=l.data.response.data;m.value={index:p.index,totalAmount:p.amount,currentAmount:p.gather,remaindate:p.remaindate,category:"자산"}}else console.error("자산 목표를 불러오지 못했습니다.")}catch(l){console.error("자산 목표 로드 중 오류가 발생했습니다.",l)}},j=async()=>{b.value=!0;try{const l=await w.get("/goal/outcome");if(l.data.success){const p=l.data.response.data.map(d=>({id:d.index,title:d.title,totalAmount:d.amount,gather:d.gather||0,priority:d.priority,progress:d.gather/(d.amount||1)*100})).sort((d,v)=>d.priority-v.priority);c.value=p}}catch(l){console.error("소비 목표를 불러오지 못했습니다.",l)}finally{b.value=!1}};return ee(async()=>{await Y(),await j()}),(l,p)=>(f(),x(B,null,[e("div",pt,[e("section",_t,[!m.value||g.value||m.value.totalAmount===0?(f(),x("div",{key:0,class:"goal-card empty-goal-card",onClick:K},bt)):(f(),x("div",{key:1,class:"progress-bar-container",onClick:J},[e("p",gt,[D(" 김리치님의 목표 자산 현황"),yt,e("strong",null,h(m.value.title)+" : "+h(m.value.totalAmount.toLocaleString())+"원",1),D("까지 "),e("strong",null,h(m.value.remaindate),1),D("일 남았습니다 💪 ")]),e("p",ft,[D(" 현재 "),e("strong",null,h(m.value.currentAmount.toLocaleString()),1),D("원 모았습니다 😁 ")]),e("div",xt,[e("div",{class:"progress",style:T({width:m.value.currentAmount/m.value.totalAmount*100+"%"})},null,4)])]))]),e("div",wt,[$t,e("section",Gt,[(f(!0),x(B,null,te(c.value,(d,v)=>(f(),x("div",{key:d.id,class:"goal-card",draggable:!0,onDragstart:E=>u(d),onDragover:p[0]||(p[0]=oe(()=>{},["prevent"])),onDrop:E=>n(d),onClick:E=>q(d)},[e("p",At,h(v+1)+". "+h(d.title),1),e("p",Ct,h(d.totalAmount.toLocaleString())+"원 / "+h(d.gather.toLocaleString())+"원",1),e("div",Mt,[e("div",{class:"progress",style:T({width:d.gather/d.totalAmount*100+"%"})},null,4)]),e("p",Dt,h((d.gather/d.totalAmount*100).toFixed(2))+"% 달성",1)],40,kt))),128)),e("div",{class:"goal-card add-goal",onClick:O},Lt)]),t.value?(f(),x("div",St," 🎉 목표를 달성했습니다! 축하합니다! 🎉 ")):P("",!0)]),A(ge,{ref_key:"goalCreateModal",ref:y,onRegisterGoal:M},null,512),A(Ve,{ref_key:"goalDetailModal",ref:o,onDeleteGoal:X,onAchieveGoal:W},null,512),A(Ke,{ref_key:"assetGoalDetailModal",ref:a,onGoalDeleted:Q},null,512),A(mt,{ref_key:"assetGoalCreateModal",ref:r,onRegisterGoal:H},null,512)]),b.value?(f(),x("div",Ft,"Loading...")):P("",!0)],64))}},Tt=L(Vt,[["__scopeId","data-v-dde43887"]]);export{Tt as default};
