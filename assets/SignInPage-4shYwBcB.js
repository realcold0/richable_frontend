import{_ as V,r as g,b as P,c as T,a as e,w as y,v as x,d as R,n as j,e as O,f as A,g as _,u as Q,h as D,o as E,i as f,p as z,j as B}from"./index-E7HFo_Uv.js";import{a as u}from"./axios-CCb-kr4I.js";const J="/richable_frontend/assets/navbar-full-rich-Cdn1ol5G.png",N="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAtCAYAAADV2ImkAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJfSURBVGhD7Zm/axNhGMe/d8ZWYxKbioqklUqVju6OgjgI4qAO4iAOFlyyaNUu4hK1umQR6iAO4qAOIjiI4ODg4l8gGixtg6hoiPnRH9aL97w+uTslJ8Y+j95BPu+Q+z45ch/Cc+/7wmu1XBAjbP6MDbET9lrCcRzUajU0m01zHQVs20YymUQ6nTbXhCdcrVZNMZVKwbIs8+X/htTq9br5zGQypua1BP2zUZIlyIWcGo0GVwLC1AZRkm1DTsEW7c0S2vSEtekJa9O1cMsdTsgII3hPcNBvdYu30pXLZeRyOVP8HQ8+3saTykNOPpY7zg1fwej6Ma74nH59FF9by5x89mcP4fDmE5zCCbp1LVyYPYvpd9c5/cxAYhDPd5ewMTHAlR+MvUxi0Vng5DO+7Qwmt1/jFE7QTbSHqysV3Hpf5KSDqDD1ZHH+El58ecYVecRnCZK+8HYclZVPXJFFZVqbWXyDqblJTrKoCBN3P9zE48/3OcmhJkwUZifQ+FbjJIOq8PzSDPKl42aRkEJMuM/ux77sQU4+TyuPsOwscVo9YsK2O4qjdzDUP8IVHURbYsOatLtyTXHSQbyHDwwewbEtpzjJo/LSTQwXMLJuJydZVISziU24vGPa7OCkUREm9mT2Ij90UVxaTZg4uTXvbjWznGQQ28CvtfpwY9c9Tj6lhVe4OnfebIp+5Z9s4OnBnR5O0FzcibCVjtrlT1pmVRt4egCJdRphBO8Jjr/pb9Ue1qAnrE1PWJv4CtP5Bk/JkYKc2gcyhHdFpzXtA5CoQC7kRG5tvJUudsdecSFmLx3wHRlq/Ctuwl6lAAAAAElFTkSuQmCC",n=p=>(z("data-v-7c80c48a"),p=p(),B(),p),q={id:"singin",class:"login-container"},Y=n(()=>e("img",{class:"title",src:J},null,-1)),Z={class:"mb-3 text-start"},H=n(()=>e("label",{for:"id",class:"form-label"},"아이디",-1)),M={class:"mb-3 text-start position-relative"},L=n(()=>e("label",{for:"password",class:"form-label"},"비밀번호",-1)),G={class:"password-input-wrapper position-relative"},K=["type"],F=["aria-label"],X=["disabled"],$={class:"d-flex justify-content-center mt-3"},W=n(()=>e("span",{class:"mx-2"}," | ",-1)),ee=n(()=>e("div",{class:"or-divider"},"또는",-1)),se=n(()=>e("img",{src:"https://via.placeholder.com/40?text=K",alt:"Kakao"},null,-1)),ae={class:"mt-3"},te=n(()=>e("span",null,"Richable이 처음이에요?",-1)),w="http://localhost:8080/member",oe={__name:"SignInPage",setup(p){const l=g(""),c=g(""),i=g(!0),m=Q(),I=()=>{i.value=!i.value},S=async()=>{var o,a,s,r;try{const t=await u.get(`${w}/naverlogin`);console.log("Naver login response:",t.data),t.data.success&&((a=(o=t.data.response)==null?void 0:o.data)!=null&&a.redirectUrl)?(localStorage.setItem("naverState",t.data.response.data.state),window.location.href=t.data.response.data.redirectUrl):(console.error("Invalid response format:",t.data),alert("네이버 로그인을 시작하는 데 문제가 발생했습니다. 잠시 후 다시 시도해 주세요."))}catch(t){console.error("Naver login initiation failed:",t),alert(`네이버 로그인 초기화 중 오류: ${((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.error)||t.message}`)}},C=async()=>{var r,t,b,k;const o=new URLSearchParams(window.location.search),a=o.get("code"),s=o.get("state");if(a&&s)try{const d=localStorage.getItem("naverState");if(s!==d)throw new Error("Invalid state");const h=await u.get(`${w}/naverCallback`,{params:{code:a,state:s}});if(h.data.success&&((t=(r=h.data.response)==null?void 0:r.data)!=null&&t.token)){const{token:v,userInfo:re}=h.data.response.data;console.log("Naver login success:",v),alert("네이버 로그인 성공!"),sessionStorage.setItem("authToken",v),localStorage.removeItem("naverState"),u.defaults.headers.common.Authorization=`Bearer ${v}`,localStorage.removeItem("naverState"),redirectUrl?window.location.href=redirectUrl:m.push({name:"home"})}else throw new Error("Invalid response format")}catch(d){console.error("Naver login callback failed:",d),alert(`네이버 로그인 처리 중 오류: ${((k=(b=d.response)==null?void 0:b.data)==null?void 0:k.error)||d.message}`),m.push({name:"login"})}},U=async()=>{var o,a;if(!l.value||!c.value){alert("아이디와 비밀번호를 모두 입력해주세요");return}try{const s=await u.post(`${w}/login`,{id:l.value,password:c.value});if(s.data.success&&((a=(o=s.data.response)==null?void 0:o.data)!=null&&a.token)){const r=s.data.response.data.token;console.log("Token received:",r),alert("Login successful!"),localStorage.setItem("authToken",r),m.push({name:"home"})}else throw new Error("Invalid response format")}catch(s){console.error("Login failed:",s),alert("Login failed. Please check your credentials.")}};return P(()=>{C();const o=localStorage.getItem("authToken");o&&(u.defaults.headers.common.Authorization=`Bearer ${o}`)}),(o,a)=>{const s=D("router-link");return E(),T("div",q,[Y,e("form",{onSubmit:O(U,["prevent"])},[e("div",Z,[H,y(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=r=>l.value=r),class:"form-control",id:"id",placeholder:"아이디를 입력해주세요",required:""},null,512),[[x,l.value]])]),e("div",M,[L,e("div",G,[y(e("input",{type:i.value?"text":"password","onUpdate:modelValue":a[1]||(a[1]=r=>c.value=r),class:"form-control",id:"password",placeholder:"비밀번호를 입력해주세요",required:""},null,8,K),[[R,c.value]]),e("span",{onClick:I,class:"position-absolute top-50 end-0 translate-middle-y pe-2",style:{cursor:"pointer"},"aria-label":i.value?"비밀번호 숨기기":"비밀번호 보이기"},[e("i",{class:j(i.value?"bi bi-eye-slash":"bi bi-eye")},null,2)],8,F)])]),e("button",{type:"submit",class:"login-btn",disabled:!l.value||!c.value},"로그인",8,X)],32),e("div",$,[A(s,{to:"/user/findid",class:"join-link"},{default:_(()=>[f("아이디 찾기")]),_:1}),W,A(s,{to:"/user/findpassword",class:"join-link"},{default:_(()=>[f("비밀번호 찾기")]),_:1})]),ee,e("div",{class:"sns-buttons"},[se,e("img",{src:N,alt:"Naver",onClick:S})]),e("div",ae,[te,A(s,{to:"/user/signup",class:"join-link"},{default:_(()=>[f("가입하기")]),_:1})])])}}},ce=V(oe,[["__scopeId","data-v-7c80c48a"]]);export{ce as default};
