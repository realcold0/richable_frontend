import{_ as He,r as l,m as M,b as Je,c as q,a as e,z as h,w as Oe,L as Qe,i as S,F as We,A as Xe,n as Le,e as Pe,C as G,o as H,p as Ye,j as ea}from"./index-E7HFo_Uv.js";import{C as V,P as aa,A as ta,p as sa,a as na,B as la,b as oa,c as ra,L as ia,d as ca,e as ua,f as da}from"./chart-BZRWlfz0.js";import{a as u}from"./AxiosInstance--4YUcpg_.js";import"./axios-CCb-kr4I.js";const f=x=>(Ye("data-v-b3d84fcc"),x=x(),ea(),x),va={class:"content-container"},pa={class:"total-asset"},ha=f(()=>e("div",{class:"asset-title"},"김리치님의 총 자산 현황 😎",-1)),fa={class:"asset-amount"},ga=f(()=>e("div",{class:"asset-level-container"},[e("div",{class:"asset-level-title"},[S("김리치님은 "),e("strong",null,"씨앗 단계"),S("예요")]),e("div",{class:"asset-level-sub"},"0원 ~ 1천만원 이하의 유저입니다."),e("div",{class:"asset-level-img"})],-1)),_a={class:"asset-analysis-container"},ma={class:"asset-analysis-nav"},ya=f(()=>e("div",{class:"asset-analysis-title"},"나의 자산",-1)),ba={class:"asset-analysis-btn"},Ca=f(()=>e("p",null,"현물자산 포함",-1)),Aa={class:"asset-analysis-content"},ka={class:"asset-analysis-content-container1"},Ma={class:"graph-container2"},Sa={class:"graph-title2"},xa=f(()=>e("br",null,null,-1)),La={class:"asset-analysis-graph"},Pa={class:"asset-analysis-table-wrapper"},wa={class:"table table-hover"},Ia=f(()=>e("th",null,"총 상품자산",-1)),Fa=["onClick"],Ba={class:"pagination justify-content-center"},Ra={class:"page-item disabled"},Da={class:"page-link",href:"#"},$a={class:"text-center asset-analysis-content-container2"},Ea=f(()=>e("br",null,null,-1)),Va={class:"asset-analysis-graph-container2"},Ta={class:"asset-analysis-container"},ja=f(()=>e("div",{class:"asset-analysis-nav"},[e("div",{class:"asset-analysis-title",style:{"font-size":"20px","font-weight":"700","line-height":"150%","letter-spacing":"-0.4px"}},"나의 자산 한 눈에 보기")],-1)),za={class:"graph-container-wrapper"},Na={class:"graph-container"},Ka=f(()=>e("div",{class:"graph-title"},"저축량",-1)),Ua={class:"graph-sum"},Za={class:"graph-container"},qa=f(()=>e("div",{class:"graph-title"},"주식 수익률",-1)),Ga={class:"graph-sum"},Ha={class:"graph-container"},Ja=f(()=>e("div",{class:"graph-title"},"코인 수익률",-1)),Oa={class:"graph-sum"},Qa={class:"graph-container"},Wa=f(()=>e("div",{class:"graph-title"},"채권 수익률",-1)),Xa={class:"graph-sum"},Ya={__name:"AssetAnalysisPage",setup(x){V.register(aa,ta,sa,na,la,oa,ra,ia,ca,ua,da);const y=l(!1),L=l(0),T=l(0),A=l([]),P=l({}),w=l({}),j=l({}),z=l({}),I=l([]),J=l([]),O=l([]),F=l([]),B=l([]),R=l([]),D=l([]),Q=l(0),W=l(0),X=l(0),Y=l(0),b=l(""),d=l(1),m=l(6),ee=l(null),N=l(null),ae=l(null),te=l(null),se=l(null),ne=l(null);let K=null,U=null,we=null,Ie=null,Fe=null,Be=null;const le=M(()=>y.value?T.value:L.value),C=M(()=>y.value?O.value:J.value);M(()=>{const t=L.value,n=y.value?[P.value,w.value].reduce((a,o)=>a+((o==null?void 0:o.amount)||0),0):0;return t+n});const oe={car:"자동차",elec:"전자기기",brand:"브랜드",luxury:"명품",etc:"기타"},Re=M(()=>{if(_.value.length>0){const t=_.value.reduce((n,a)=>n.amount>a.amount?n:a);return{prodCategory:oe[t.prodCategory]||t.prodCategory,amount:t.amount}}return{prodCategory:"자산",amount:0}}),Z=t=>t.toLocaleString("ko-KR"),De=(t,n,a,o)=>{var i,v,c,g;Q.value=((i=t.find(p=>p.month===1))==null?void 0:i.earningRate)||0,W.value=((v=n.find(p=>p.month===1))==null?void 0:v.earningRate)||0,X.value=((c=a.find(p=>p.month===1))==null?void 0:c.earningRate)||0,Y.value=(((g=o.find(p=>p.month==="2024-10"))==null?void 0:g.balance)/1e4).toFixed(0)||0},re=async()=>{var t,n,a,o,i,v,c,g,p,k,ie,ce,ue,de,ve,pe,he,fe,ge,_e,me,ye,be,Ce,Ae,ke,Me,Se,xe;try{const s=await Promise.allSettled([u.get("/finance/fin/sum"),u.get("/finance/total/sum"),u.get("/finance/fin"),u.get("/finance/changed/fin"),u.get("/finance/changed/spot"),u.get("/finance/spot/elec/sum"),u.get("/finance/spot/etc/sum"),u.get("/finance/spot/car/sum"),u.get("/finance/spot/luxury/sum"),u.get("/finance/spot/brand/sum"),u.get("/finance/return/income"),u.get("/finance/return/bond"),u.get("/finance/return/coin"),u.get("/finance/return/stock")]);L.value=s[0].status==="fulfilled"&&((o=(a=(n=(t=s[0].value)==null?void 0:t.data)==null?void 0:n.response)==null?void 0:a.data)==null?void 0:o.amount)||0,T.value=s[1].status==="fulfilled"&&((g=(c=(v=(i=s[1].value)==null?void 0:i.data)==null?void 0:v.response)==null?void 0:c.data)==null?void 0:g.amount)||0,A.value=s[2].status==="fulfilled"?s[2].value.data.response.data:[],J.value=s[3].status==="fulfilled"?((ie=(k=(p=s[3].value)==null?void 0:p.data)==null?void 0:k.response)==null?void 0:ie.data)||{}:{},O.value=s[4].status==="fulfilled"?((de=(ue=(ce=s[4].value)==null?void 0:ce.data)==null?void 0:ue.response)==null?void 0:de.data)||{}:{},P.value=s[5].status==="fulfilled"?((he=(pe=(ve=s[5].value)==null?void 0:ve.data)==null?void 0:pe.response)==null?void 0:he.data)||{}:{},w.value=s[6].status==="fulfilled"?((_e=(ge=(fe=s[6].value)==null?void 0:fe.data)==null?void 0:ge.response)==null?void 0:_e.data)||{}:{},j.value=s[7].status==="fulfilled"?((be=(ye=(me=s[7].value)==null?void 0:me.data)==null?void 0:ye.response)==null?void 0:be.data)||{}:{},luxSpot.value=s[8].status==="fulfilled"?((ke=(Ae=(Ce=s[8].value)==null?void 0:Ce.data)==null?void 0:Ae.response)==null?void 0:ke.data)||{}:{},z.value=s[9].status==="fulfilled"?((xe=(Se=(Me=s[9].value)==null?void 0:Me.data)==null?void 0:Se.response)==null?void 0:xe.data)||{}:{},D.value=s[10].status==="fulfilled"?s[10].value.data.response.data:[],B.value=s[11].status==="fulfilled"?s[11].value.data.response.data:[],R.value=s[12].status==="fulfilled"?s[12].value.data.response.data:[],F.value=s[13].status==="fulfilled"?s[13].value.data.response.data:[],s.forEach((r,Ge)=>{r.status==="rejected"&&console.error(`API 호출 실패: ${Ge} - ${r.reason}`)}),console.log(L.value),console.log(T.value),$e(),I.value=_.value.slice((d.value-1)*m.value,d.value*m.value),Te(ee,"doughnut",_.value.map(r=>r.prodCategory),_.value.map(r=>r.amount)),Array.isArray(C.value)?Ve(C.value.map(r=>$(r.month)),C.value.map(r=>r.balance)):console.error("displayedSixMonth.value는 배열이 아닙니다:",C.value),De(F.value,B.value,R.value,D.value);const Ke=F.value.map(r=>$(r.month)),Ue=B.value.map(r=>$(r.month)),Ze=D.value.map(r=>r.month),qe=R.value.map(r=>$(r.month));Ee(Ke,F.value.map(r=>r.earningRate),Ue,B.value.map(r=>r.earningRate),Ze,D.value.map(r=>r.balance),qe,R.value.map(r=>r.earningRate))}catch(s){console.error("API 호출 중 오류 발생:",s)}},$e=()=>{var v,c;const t=((v=C.value[0])==null?void 0:v.balance)||0,n=((c=C.value[1])==null?void 0:c.balance)||0,a=t-n,o=Math.floor(a/1e8),i=Math.floor(a%1e8/1e4);a>0?a>=1e8?b.value=`${o}억 ${i}만원 늘었어요 🥰`:b.value=`${i}만원 늘었어요 🥰`:a<0?Math.abs(a)>=1e8?b.value=`${Math.abs(o)}억 ${Math.abs(i)}만원 줄었어요 🥺`:b.value=`${Math.abs(i)}만원 줄었어요 🥺`:b.value="변화가 없어요"},_=M(()=>{const n=(y.value?[...Array.isArray(A.value)?A.value:[],...P.value?[P.value]:[],...w.value?[w.value]:[],...z.value?[z.value]:[],...j.value?[j.value]:[]]:Array.isArray(A.value)?A.value:[]).map(a=>({...a,prodCategory:oe[a.prodCategory]||a.prodCategory}));return n.length===0&&console.error("displayedAssetList is empty:",n),n}),Ee=async(t,n,a,o,i,v,c,g)=>{await G(),E(ae,we,a,o),E(te,Ie,t,n),E(se,Fe,i,v,!0),E(ne,Be,c,g)},$=t=>{const o=new Date().getMonth()+2-t,i=o>0?o:12+o;return t===1?"이번달":`${i}월`},Ve=async(t,n)=>{if(await G(),!N.value)return;U&&U.destroy();const a=t.reverse(),o=n.reverse();U=new V(N.value,{type:"bar",data:{labels:a,datasets:[{data:o,backgroundColor:a.map(i=>i==="이번달"?"rgba(255,0,98,0.67)":"rgba(220,212,212,0.63)"),borderRadius:{topLeft:10,topRight:10},borderSkipped:"bottom"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0}},scales:{y:{display:!1},x:{grid:{display:!1}}}}})},Te=async(t,n,a,o)=>{if(await G(),!!t.value){if(!a||a.length===0||!o||o.length===0){console.error("차트 렌더링에 필요한 데이터가 비어있습니다.");return}K&&K.destroy(),K=new V(t.value.getContext("2d"),{type:n,data:{labels:a,datasets:[{data:o,backgroundColor:["#C30044","#FF0062","#DA0052","#FFF2F6","#FF99CC","#FF6699"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})}},E=(t,n,a,o,i=!1)=>{if(!t.value)return;n&&n.destroy();const v=a.reverse(),c=o.reverse(),g=Math.min(...c),p=Math.max(...c);n=new V(t.value,{type:"line",data:{labels:v,datasets:[{data:c,backgroundColor:"rgba(250, 158, 190, 1)",borderColor:"rgba(250, 158, 190, 1)",pointRadius:3,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!0,scales:{x:{grid:{display:!1}},y:{beginAtZero:!1,suggestedMin:g-10,suggestedMax:p+10,ticks:{callback:function(k){return i?k.toLocaleString()+"원":k+"%"}}}},plugins:{legend:{display:!1},tooltip:{enabled:!0}}}})},je=()=>{d.value<Math.ceil(_.value.length/m.value)&&(d.value++,I.value=_.value.slice((d.value-1)*m.value,d.value*m.value))},ze=()=>{d.value>1&&(d.value--,I.value=_.value.slice((d.value-1)*m.value,d.value*m.value))},Ne=()=>{re()};return Je(()=>{re()}),(t,n)=>(H(),q("div",null,[e("div",va,[e("div",pa,[ha,e("div",fa,h(Z(le.value))+"원",1)]),ga,e("div",_a,[e("div",ma,[ya,e("div",ba,[Oe(e("input",{type:"checkbox","onUpdate:modelValue":n[0]||(n[0]=a=>y.value=a),onChange:Ne},null,544),[[Qe,y.value]]),Ca])]),e("div",Aa,[e("div",ka,[e("div",Ma,[e("p",Sa,[S(h(Re.value.prodCategory)+" 자산 비중이 ",1),xa,S(" 제일 높아요")]),e("div",La,[e("canvas",{ref_key:"pieChart",ref:ee},null,512)])]),e("div",Pa,[e("table",wa,[e("thead",null,[e("tr",null,[Ia,e("th",null,h(Z(le.value))+"원",1)])]),e("tbody",null,[(H(!0),q(We,null,Xe(I.value,(a,o)=>(H(),q("tr",{key:o,onClick:i=>t.toggleDetails(a),class:"clickable-row"},[e("td",null,h(a.prodCategory),1),e("td",null,h(Z(a.amount))+"원",1)],8,Fa))),128))])]),e("nav",null,[e("ul",Ba,[e("li",{class:Le(["page-item",{disabled:d.value===1}])},[e("a",{class:"page-link",href:"#",onClick:Pe(ze,["prevent"])},"Previous")],2),e("li",Ra,[e("a",Da,"Page "+h(d.value)+" of "+h(t.totalPages),1)]),e("li",{class:Le(["page-item",{disabled:d.value===t.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:Pe(je,["prevent"])},"Next")],2)])])])]),e("div",$a,[e("p",null,[S("총자산이 지난달보다 "),Ea,e("strong",null,h(b.value),1)]),e("div",Va,[e("canvas",{class:"text-center",ref_key:"barChart",ref:N},null,512)])])])]),e("div",Ta,[ja,e("div",za,[e("div",Na,[Ka,e("div",Ua,h(Y.value)+"만원",1),e("canvas",{class:"graph",ref_key:"lineChart3",ref:se},null,512)]),e("div",Za,[qa,e("div",Ga,h(X.value)+"%",1),e("canvas",{class:"graph",ref_key:"lineChart4",ref:ne},null,512)]),e("div",Ha,[Ja,e("div",Oa,h(W.value)+"%",1),e("canvas",{class:"graph",ref_key:"lineChart1",ref:ae},null,512)]),e("div",Qa,[Wa,e("div",Xa,h(Q.value)+"%",1),e("canvas",{class:"graph",ref_key:"lineChart2",ref:te},null,512)])])])])]))}},nt=He(Ya,[["__scopeId","data-v-b3d84fcc"]]);export{nt as default};
